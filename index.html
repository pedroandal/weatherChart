<!DOCTYPE html>
<html>
<head>
<title>Desafio - Grafico de temperaturas</title>
<style>
	th[onclick] {
		cursor: pointer;
	}

	table, th, td {
		border: thin solid;
	}
</style>
</head>
<body>
<form onsubmit="return add(this)">
	<label>Introduza a cidade: <input type="text" name="cidade"/></label>
	<input type="submit" value="Adicionar">
</form>


<ul id="lista">
</ul>




<template id="productrow">
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</template>

<table style="border-collapse:collapse">
	<thead>
		<tr>
			<th rowspan="2">Cidade</th><th colspan="2">Temperatura</th><th colspan="2">Hor&aacute;rio In&iacute;cio</th>
		</tr>
		<tr>
			<th onclick="order('tempMin')">M&iacute;nima</th><th onclick="order('tempMax')">M&aacute;xima</th><th onclick="order('horaMin')">Dia</th><th onclick="order('horaMax')">Noite</th></tr>
		</tr>
	</thead>
	<tbody>
		
	</tbody>
</table>

<script>
	var fn = (function(){
		"use strict";
		var ordenacao, dados = [];

		function ajax(url, fn){

		}

		return {
			orderBy: function(key) {
				dados.sort(function(a,b){
					if(key == 'tempMin' || key == 'tempMax')
						return parseFloat(a[key]) > parseFloat(b[key]);
					else if(key == 'horaMin' || key == 'horaMax') 
						return parseFloat(a[key].replace(':', '.')) > parseFloat(b[key].replace(':', '.'));
					else
						return a[key] > b[key];
				});

				if(ordenacao == key) {
					dados.reverse();
				}
				ordenacao = key;
			},

			addCity: function(form){
				var c = form['cidade'];

				var registo = ajax('/query/'+c.value, function(data){
					var row = '<td>' + Object.values(registo).join('</td><td>') + '</td>';
					document.querySelector('').innerHTML+=row;

					dados.push(registo);	
				});

				document.getElementById('lista').innerHTML+="<li>"+c.value+"</li>";
				c.value='';
			return false;
			}
		}
	})();

	var order = fn.orderBy;
	var add = fn.addCity;
</script>
</body>
</html>